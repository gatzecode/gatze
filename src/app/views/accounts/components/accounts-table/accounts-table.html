<div class="table-container">
  <div class="table-header">
    <div>
      <div class="table-title">
        <mat-icon>credit_card</mat-icon>
        Cuentas de Crédito
      </div>
      @if (hasAccounts() && !loading()) {
        <div class="table-count">{{ totalAccounts() }} {{ totalAccounts() === 1 ? 'cuenta' : 'cuentas' }}</div>
      }
    </div>
  </div>

  @if (loading()) {
    <div class="loading-state">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
  } @else if (hasAccounts()) {
    <table mat-table [dataSource]="accounts()" class="accounts-table">
      <!-- Card Number Column -->
      <ng-container matColumnDef="card">
        <th mat-header-cell *matHeaderCellDef>Tarjeta</th>
        <td mat-cell *matCellDef="let account">
          <div class="flex items-center gap-2">
            <mat-icon class="text-indigo-500 text-base">credit_card</mat-icon>
            <span class="card-number">{{ formatCardNumber(account.card) }}</span>
          </div>
        </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Tarjetahabiente</th>
        <td mat-cell *matCellDef="let account">
          <span class="account-name">{{ account.name }}</span>
        </td>
      </ng-container>

      <!-- Account Number Column -->
      <ng-container matColumnDef="accountNumber">
        <th mat-header-cell *matHeaderCellDef>Número de Cuenta</th>
        <td mat-cell *matCellDef="let account">
          <span class="account-number">{{ account.accountNumber }}</span>
        </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let account">
          <span class="status-chip status-active">ACTIVA</span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns;"
        [class.selected]="isSelected(row)"
        (click)="onSelectAccount(row)"
        matTooltip="Click para ver detalles">
      </tr>
    </table>
  } @else {
    <div class="empty-state">
      <mat-icon>search_off</mat-icon>
      <h3 class="text-lg font-medium text-gray-900 mb-2">No se encontraron cuentas</h3>
      <p class="text-sm text-gray-500">Ajusta los filtros de búsqueda o crea una nueva cuenta</p>
    </div>
  }
</div>
